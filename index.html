<!DOCTYPE html>
<html lang="en">
<head>
	<title>Small intro to Python packaging</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=792, user-scalable=no">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<link rel="stylesheet" href="styles/screen.css">
</head>
<body class="list">
	<header class="caption">
		<h1>Small intro to Python packaging</h1>
		<p><a href="http://djangostars.com">Vasyl Dizhak</a></p>
	</header>
  
  
  <!-- Home -->
  <section class="slide  active" id="Home"><div>
  		<h2 style="margin-top: 150px">Small intro to Python packaging</h2>
  		<p>Vasyl Dizhak <a href="">@rootart</a> </p>
      <p>Project Lead at <a href="http://djangostars.com">Django Stars</a>, vasyl.dizhak@djangostars.com</p>
  	</div></section>

  	<section class="slide shout"><div>
  		<h2>
        <a style="font-size: 0.7em;" href="http://bit.ly/lvivpy-packaging">http://bit.ly/lvivpy-packaging</a>
      </h2>
  	</div></section>

  <!-- IMG -->
  <section class="slide cover active" id="Cover"><div>
  		<img src="img/package.jpg" alt="">
  	</div></section>

  	<section class="slide" id="WhatIsAPackage"><div>
  		<figure>
  			<blockquote style="font-size: 1.5em; ">
  				<p>Packages are a way of structuring Python's <mark>module namespace</mark> by using "dotted module names".</p>
  			</blockquote>
  			<figcaption>An Introduction to Python
by Guido van Rossum and Fred L. Drake, Jr</figcaption>
  		</figure>
  	</div></section>
    
  	<section class="slide" id="WhyIShouldUseIt"><div>
  		<h2>Why I should use it?</h2>
  		<ol>
  			<li>Extremely simple for users</li>
  			<li class="next">As a package author you will like it</li>
  			<li class="next">Neat way to distribute your package and simplify deployments</li>
  			<li class="next"><mark>PEP 20</mark> There should be one-- and preferably only one --obvious way to do it.</li>
        <li class="next">Play nice with others</li>
  			<li class="next">Because you want to share packages for free</li>
  		</ol>
  	</div></section>

  	<section class="slide" id="Quote"><div>
  		<figure>
  			<blockquote style="font-size: 3em; ">
  				<p>Software is like sex: it's better when it's free.</p>
  			</blockquote>
  			<figcaption>Linus Torvalds</figcaption>
  		</figure>
  	</div></section>


    <section class="slide active" id="CurrentState"><div>
      <figure><img src="img/state_of_packaging.jpg" alt=""></figure>
      <div>The Hitchhiker's Guide to Packaging 1.0 documentation <a href="http://guide.python-distribute.org/introduction.html#current-state-of-packaging">link</a></div>
    	</div></section>


      <section class="slide cover w" id="PM"><div>
        <img src="img/pm.png" alt="">
      	</div></section>


  	<section class="slide" id="MinimalStructure"><div>
      <h2>Minimal structure</h2>
      <pre>
        <code>
          ➜  development $ tree -L 2 VotePackage
          VotePackage
          ├── MANIFEST
          ├── README.txt
          ├── <mark>setup.py</mark>
          └── votepackage
              └── <mark>__init__.py</mark>
          2 directories, 6 files
        </code>
      </pre>
  	</div></section>
  
  
  	<section class="slide" id="MinimalSetup"><div>
      <h2>Minimal setup.py data</h2>
      <pre>
        <code style="font-size: 0.7em; line-height: 1.4em">
          from <mark>distutils</mark>.core import <mark>setup</mark>
          setup(
              name='VotePackage',
              version='0.1dev',
              author='Vasyl Dizhak',
              author_email='vasyl.dizhak@djangostars.com',
              description='Centralized system for python package voting',
              packages=['votepackage',],
              license='Simplified BSD License',
              long_description=open('README.txt').read(),
          )
        </code>
      </pre>
  	</div></section>
    

  	<section class="slide" id="MinimalSetupName"><div>
      <h2>Minimal setup.py data: <mark>name</mark></h2>
      <pre>
        <code style="font-size: 0.9em; line-height: 1.4em">
          <mark>...</mark>
          name='VotePackage'
          <mark>...</mark>
        </code>
      </pre>
      Has to be unique name.
      <pre>
        <code style="font-size: 0.9em; line-height: 1.4em">
          http://pypi.python.org/pypi/<mark>&lt;name&gt;</mark>
        </code>
      </pre>
  	</div></section>


  	<section class="slide" id="MinimalSetupPackage"><div>
      <h2>Minimal setup.py data: <mark>packages</mark></h2>
      <pre><code>
packages=<mark>['votepackage', 'votepackage.tests']</mark>
        </code>
      </pre>
  	</div></section>

  	<section class="slide" id="MinimalSetupVersion"><div>
      <h2>Minimal setup.py data: <mark>version</mark></h2>
      PEP 386 -- Changing the version comparison module in Distutils <a href="http://www.peps.io/386/">http://www.peps.io/386/</a>
      <pre>
        <code style="font-size: 0.9em; line-height: 1.4em">
 >>> from distutils.version import <mark>LooseVersion</mark> as V
 >>> v1 = V(<mark>'1.0dev'</mark>)
 >>> v2 = V(<mark>'1.0.9alpha'</mark>)
 >>> v2 > v1
 >>> False
        </code>
      </pre>

      <pre>
        <code style="font-size: 0.9em; line-height: 1.4em">
$ pip install -U <mark>name</mark>
        </code>
      </pre>
  	</div></section>


  	<section class="slide" id="MinimalSetupAuthor"><div>
      <h2>Minimal setup.py data: <mark>author</mark></h2>
      People may buy you a beer <a href="www.gittip.com">www.gittip.com</a>
      <pre>
        <code style="font-size: 0.9em; line-height: 1.4em">
  <mark>author</mark>='Vasyl Dizhak',
  <mark>author_email</mark>='vasyl.dizhak@djangostars.com',
  
  
  <mark>maintainer</mark>='Vasyl Dizhak',
  <mark>maintainer_email</mark>='vasyl.dizhak@djangostars.com',
 
        </code>
      </pre>
  	</div></section>


  	<section class="slide" id="MinimalSetupDescription"><div>
      <h2>Minimal setup.py data: <mark>description</mark></h2>
      May be a first or even the <mark>only</mark> place where users will look and decide whether they will use your package.
      PYPI will render <mark>long_description</mark> with docutils reStructuredText renderer
      <pre><code>
<mark>long_description</mark>=open('README.md').read(),
        </code>
      </pre>
  	</div></section>

  	<section class="slide" id="MinimalSetupFiles"><div>
      <h2>Minimal setup.py data: <mark>MANIFEST.in</mark></h2>
          Only Python modules and packages are included in the package by default. To include additional files, we’ll need to create a MANIFEST.in file
      <pre><code>
<mark>include</mark> LICENSE
include README.rst
<mark>recursive-include</mark> votepackage/static *
recursive-include votepackage/templates *
        </code>
      </pre>
  	</div></section>

  	<section class="slide" id="MinimalSetupRequirements"><div>
      <h2>setup: <mark>requirements</mark></h2>
      <pre><code>
        <mark>install_requires</mark> = [
            'requests',
            'pycli'
        ],

        </code>
      </pre>
  	</div></section>

  	<section class="slide" id="PlatformRelay"><div>
      <h2>Relay on <mark>platform</mark> or <mark>python version</mark></h2>
      <pre><code>
        if <mark>sys.version_info[:2]</mark> in ((2, 6), (3, 1)):
            # argparse has been added in Python 3.2 / 2.7
            requirements.append('argparse>=1.2.1')
        if <mark>'win32'</mark> in str(sys.platform).lower():
            # Terminal colors for Windows
            requirements.append('colorama>=0.2.4')
        </code>
      </pre>
  	</div></section>
  
  
  
  	<section class="slide" id="classifiers"><div>
      <h2>Classifiers</h2>
      PEP 301 -- Package Index and Metadata for Distutils <a href="http://peps.io/0301/">http://peps.io/0301/</a>
      <pre><code style="font-size: 0.9em; line-height: 1.4em">
        classifiers=[
            'Development Status :: 1 - Planning',
            'Intended Audience :: Developers',
            'Environment :: Console',
            'Programming Language :: Python :: 2.5',
            'Programming Language :: Python :: 2.6',
            'Programming Language :: Python :: 2.7',
            'Programming Language :: Python :: 3.3'
            'Framework :: Django'
        ]
        python setup.py register <mark>--list-classifiers</mark>
        </code>
      </pre>
  	</div></section>

  	<section class="slide" id="scripts"><div>
      <h2>Console scripts</h2>
      <pre><code style="font-size: 0.9em; line-height: 1.4em">
        <mark>scripts</mark>=['django/bin/django-admin.py']
        </code>
      </pre>
  	</div></section>

  	<section class="slide shout" id="LeanRelease"><div>
  		<h2>
        Lean release
      </h2>
  	</div></section>
  
  	<section class="slide shout" id="Register"><div>
  		<h2 style="font-size: 3em">
        $ python setup.py register
      </h2>
  	</div></section>
  
  	<section class="slide shout" id="Upload"><div>
  		<h2 style="font-size: 3em">
        $ python setup.py <mark>sdist</mark> <mark> upload</mark>
      </h2>
  	</div></section> 

	<section class="slide" id="WhatBeenDone"><div>
    <h2>What have been done?</h2>
		<ol>
			<li>Build distributition <mark>VotePackage-0.1dev.tar.gz</mark> and upload it to PYPI</li>
			<li class="next">You could build a package for your OS <mark>bdist_wininst</mark>, <mark>bdist_rpm</mark> etc</li>
      <li class="next">You can use <mark>--repository=url</mark> for uploading package to your own cheeseshop</next>
		</ol>
	</div></section>

	<section class="slide shout" id="TestingPart"><div>
		<h2>
      Testing
    </h2>
	</div></section>

	<section class="slide" id="Tox"><div>
    <h2>Tox</h2>
    <p>Use <a href="http://testrun.org/tox/latest">tox</a> to automate package testing against different python versions</p>
    <pre>
      <code style="font-size: 0.6em; line-height: 1.4em">
        import sys
        from setuptools.command.test import test as <mark>TestCommand</mark>
        class Tox(TestCommand):
            def finalize_options(self):
                TestCommand.finalize_options(self)
                self.test_args = []
                self.test_suite = True
            def run_tests(self):
                #import here, cause outside the eggs aren't loaded
                import tox
                errno = tox.cmdline(self.test_args)
                sys.exit(errno)
      </code>
    </pre>
	</div></section>

	<section class="slide" id="Tox&setup.py"><div>
    <h2>Tox.ini & setup.py</h2>
    <pre>
      <code style="font-size: 0.6em; line-height: 1.4em">
        # content of: tox.ini , put in same dir as setup.py
        [tox]
        envlist = <mark>py25,py26,py27,py33</mark>
        [testenv]
        deps=pytest       # install pytest in the venvs
        commands=<mark>py.test</mark>  # or 'nosetests' or ...

      </code>
    </pre>
    <pre>
      <code style="font-size: 0.6em; line-height: 1.4em">
        # setup.py
        <mark>...</mark>
        tests_require=['tox'], #install tox package
        cmdclass = {'test': Tox},
      
      </code>
    </pre>
	</div></section>
  
  
	<section class="slide" id="setup.py&test"><div>
    <h2>Test your package</h2>
    <pre>
      <code style="font-size: 1em; line-height: 1.4em">
        $ python setup.py <mark>test</mark>
        <mark>...</mark>
        py27 inst-nodeps: /Users/rootart/development/
          VotePackage/.tox/dist/VotePackage-0.1dev.zip
        py27 runtests: commands[0]
        <mark>...</mark>
        py25: commands succeeded
        py26: commands succeeded
        py27: commands succeeded
        py33: commands succeeded
        congratulations :)
      </code>
    </pre>
	</div></section>


    
	<section class="slide" id="AutomateTesting"><div>
    <h2>Use CI system for constant builds <img src="https://secure.travis-ci.org/rootart/pyweb101.png?branch=master"></h2>
    <ul>
      <li>https://travis-ci.org/</li>
      <li>https://www.shiningpanda-ci.com/</li>
      <li>http://jenkins-ci.org/</li>
      <li>http://trac.buildbot.net/</li>
      <li>...</li>
    </ul>
	</div></section>


	<section class="slide shout" id="AsAUser"><div>
		<h2>
      As a user
    </h2>
	</div></section>

	<section class="slide" id="PIPUsage"><div>
    <h2>PIP & virtualenv</h2>
    <pre>
      <code style="font-size: 1em; line-height: 1.4em">
        $ virtualenv <mark>env</mark>
        $ pip <mark>install/uninstall</mark> package
        $ pip <mark>freeze</mark> > requirements-dev.txt
        $ pip install <mark>-r</mark> requirements-dev.txt
        $ pip install ... -M (--mirrors) #PEP-381
        $ pip install <mark>-e</mark> git/hg/svn
      </code>
    </pre>
	</div></section>
  
	<section class="slide" id="PIPConfiguration"><div>
    <h2>PIP useful configuration options</h2>
    <pre>
      <code style="font-size: 1em; line-height: 1.4em">
        # $HOME/.pip/pip.conf
        [global]
        timeout = 60
        index-url = http://local.cheeseshop/
        <mark>download_cache</mark> = ~/.cache/pip
      </code>
    </pre>
	</div></section>

	<section class="slide" id="WheelPackages"><div>
    <h2>The Wheel Binary Package Format </h2>
    <a href="http://peps.io/427/">PEP-427</a>
    <pre>
      <code style="font-size: 1em; line-height: 1.4em">
        pip wheel [options] <requirement specifier> ...
        pip wheel [options] -r <requirements file> ...
        pip wheel [options] <vcs project url> ...
        pip wheel [options] <local project path> ...
        pip wheel [options] <archive url/path> ...
      </code>
    </pre>
	</div></section>

	<section class="slide shout" id="Future"><div>
		<h2>
      Future of python packaging
    </h2>
	</div></section>

	<section class="slide" id="FutureList"><div>
    <h2>Future of python packaging</h2>
    <ol>
      <li>standalone setup tool that install and uninstall packages</li>
      <li class="next">metadata will be available outside of Python file in <mark>setup.cfg</mark></li>
      <li class="next">already in Python 3 trun as a <mark>packaging</mark></li>
      
    </ol>
	</div></section>
  
	<section class="slide" id="Distutils2"><div>
    <h2>Some of the distutils2 features</h2>
    <a href="http://peps.io/426/">http://peps.io/426/</a>
    <pre>
      <code style="font-size: 1em; line-height: 1.4em">
        Requires-External: C
        Requires-External: <mark>libpng (>=1.5)</mark> #PIL :)
        
        <mark>Requires-Dist</mark> package; python_version == '2.5'
        
        <mark>Obsoletes-Dist</mark>: OtherProject (<3.0)
      </code>
    </pre>
	</div></section>
  
	<section class="slide" id="Follow"><div>
    <ol>
      <li>KISS</li>
      <li class="next">Follow a standards</li>
      <li class="next">Use best practices of virtualenv/pip</li>
      <li class="next">Read PEPs and lookout for new changes in distutils2</li>
      <li class="next">Share your experience</li>
    </ol>
	</div></section>

	<section class="slide shout" id="Thanks"><div>
		<h2>
      Thank you! LvivPy#2 is awesome :)
    </h2>
	</div></section>

	<section class="slide shout" id="Questions"><div>
		<h2>
      Question?
    </h2>
	</div></section>

	<p class="badge"><a href="https://github.com/rootart/lvivpy-python-packaging">Fork me on Github</a></p>
	<!--
		To hide progress bar from entire presentation
		just remove “progress” element.
		-->
	<div class="progress"><div></div></div>
	<script src="shower.js"></script>
	<!-- Copyright © 2013 Yours Truly, Famous Inc. -->
</body>
</html>